{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CovidApiService {\n  http;\n  base = 'https://disease.sh/v3/covid-19';\n  noCache = new HttpHeaders({\n    'Cache-Control': 'no-store, no-cache, must-revalidate, proxy-revalidate',\n    'Pragma': 'no-cache',\n    'Expires': '0'\n  });\n  constructor(http) {\n    this.http = http;\n  }\n  getGlobal() {\n    const t = Date.now();\n    return this.http.get(`${this.base}/all?t=${t}`, {\n      headers: this.noCache\n    });\n  }\n  getCountry(country) {\n    const t = Date.now();\n    return this.http.get(`${this.base}/countries/${encodeURIComponent(country)}?strict=true&t=${t}`, {\n      headers: this.noCache\n    });\n  }\n  getCountries() {\n    const t = Date.now();\n    return this.http.get(`${this.base}/countries?t=${t}`, {\n      headers: this.noCache\n    });\n  }\n  getHistorical(country, lastdays = 180) {\n    const t = Date.now();\n    return this.http.get(`${this.base}/historical/${encodeURIComponent(country)}?lastdays=${lastdays}&t=${t}`, {\n      headers: this.noCache\n    }).pipe(map(res => {\n      const tline = res?.timeline ?? {};\n      const toSeries = (obj = {}) => {\n        const entries = Object.entries(obj).sort((a, b) => new Date(a[0]).getTime() - new Date(b[0]).getTime());\n        return {\n          dates: entries.map(([d]) => d),\n          values: entries.map(([, v]) => v)\n        };\n      };\n      const sCases = toSeries(tline.cases);\n      const sDeaths = toSeries(tline.deaths);\n      const sRecov = toSeries(tline.recovered);\n      return {\n        dates: sCases.dates,\n        cases: sCases.values,\n        deaths: sDeaths.values,\n        recovered: sRecov.values\n      };\n    }));\n  }\n  static ɵfac = function CovidApiService_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || CovidApiService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CovidApiService,\n    factory: CovidApiService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}